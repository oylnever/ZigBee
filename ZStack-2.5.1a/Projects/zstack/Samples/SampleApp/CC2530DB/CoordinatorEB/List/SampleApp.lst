###############################################################################
#
# IAR C/C++ Compiler V10.30.1.6000 for 8051               04/Sep/2021  21:02:04
# Copyright 2004-2018 IAR Systems AB.
# PC-locked license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
#    Command line       =  
#        -f C:\Users\OY\AppData\Local\Temp\EWB6C6.tmp
#        (C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
#        -D ZTOOL_P1 -D xMT_TASK -D xMT_SYS_FUNC -D xMT_ZDO_FUNC -D
#        LCD_SUPPORTED=DEBUG -lC
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\CoordinatorEB\List
#        -lA
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\CoordinatorEB\List
#        --diag_suppress Pe001,Pa010 -o
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\CoordinatorEB\Obj
#        -e --debug --core=plain --dptr=16,1 --data_model=large
#        --code_model=banked --calling_convention=xdata_reentrant
#        --place_constants=data_rom --nr_virtual_regs 8 -f
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wCoord.cfg
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRUE
#        -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8 -DMAC_CFG_RX_MAX=5
#        -DZDO_COORDINATOR -DRTR_NWK) -f
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg
#        (-DZIGBEEPRO -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0xFFF1
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07,
#        0x09, 0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C,
#        0x0D}" -DMAC_MAX_FRAME_SIZE=116 -DZDNWKMGR_MIN_TRANSMISSIONS=20
#        "-DCONST=const __code" -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE
#        -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100
#        -DREJOIN_POLL_RATE=440) -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\Source\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\ZMain\TI2530DB\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\hal\include\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\include\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\high_level\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\mt\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\osal\include\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\services\saddr\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\services\sdata\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\af\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\nwk\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\sapi\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\sec\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\sys\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\stack\zdo\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\zmac\
#        -I
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\Components\zmac\f8w\
#        -Ohz --no_code_motion)
#    Locale             =  Chinese (Simplified)_CHN.936
#    List file          =  
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\CoordinatorEB\List\SampleApp.lst
#    Object file        =  
#        C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\CC2530DB\CoordinatorEB\Obj\SampleApp.r51
#
###############################################################################

C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c
      1          /*********************************************************************
      2           * INCLUDES
      3           */
      4          
      5          #include <stdio.h>
      6          #include <string.h>
      7          #include "AF.h"
      8          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1
      9          #include "OSAL_Tasks.h"
     10          #include "SampleApp.h"
     11          #include "ZDApp.h"
     12          #include "ZDObject.h"
     13          #include "ZDProfile.h"
     14          
     15          #include "hal_drivers.h"
     16          #include "hal_key.h"
     17          #if defined(LCD_SUPPORTED)
     18          #include "hal_lcd.h"
     19          #endif
     20          #include "hal_led.h"
     21          #include "hal_uart.h"
     22          
     23          #ifdef ZDO_COORDINATOR
     24          //协议文件
     25          #include "mqtt.h"
     26          #include "mqttkit.h"
     27          
     28          #else
     29          
     30          #include "dht11.h"
     31          
     32          #endif
     33          
     34          /*********************************************************************
     35           * MACROS
     36           */
     37          
     38          /*********************************************************************
     39           * CONSTANTS
     40           */
     41          
     42          #if !defined(SAMPLE_APP_PORT)
     43          #define SAMPLE_APP_PORT 0
     44          #endif
     45          
     46          #if !defined(SAMPLE_APP_RX_MAX)
     47          #define SAMPLE_APP_RX_MAX 200
     48          #endif
     49          
     50          // This list should be filled with Application specific Cluster IDs.

   \                                 In  segment XDATA_ROM_C, align 1
     51          const cId_t SampleApp_ClusterList[SAMPLE_MAX_CLUSTERS] =
   \                     SampleApp_ClusterList:
   \   000000   0100         DW 1
   \   000002   0200         DW 2
   \   000004   0300         DW 3
   \   000006   0400         DW 4
     52              {
     53                  SAMPLEAPP_P2P_CLUSTERID,
     54                  SAMPLEAPP_PERIODIC_CLUSTERID,
     55                  SERIALAPP_CONNECTREQ_CLUSTER,
     56                  SAMPLEAPP_CTE_CLUSTERID // coor to end
     57          };
     58          

   \                                 In  segment XDATA_ROM_C, align 1
     59          const SimpleDescriptionFormat_t SampleApp_SimpleDesc =
   \                     SampleApp_SimpleDesc:
   \   000000   0B           DB 11
   \   000001   050F         DW 3845
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   04           DB 4
   \   000007   ....         DW SampleApp_ClusterList
   \   000009   04           DB 4
   \   00000A   ....         DW SampleApp_ClusterList
     60              {
     61                  SAMPLEAPP_ENDPOINT,             //  int   Endpoint;
     62                  SAMPLEAPP_PROFID,               //  uint16 AppProfId[2];
     63                  SAMPLEAPP_DEVICEID,             //  uint16 AppDeviceId[2];
     64                  SAMPLEAPP_DEVICE_VERSION,       //  int   AppDevVer:4;
     65                  SAMPLEAPP_FLAGS,                //  int   AppFlags:4;
     66                  SAMPLE_MAX_CLUSTERS,            //  byte  AppNumInClusters;
     67                  (cId_t *)SampleApp_ClusterList, //  byte *pAppInClusterList;
     68                  SAMPLE_MAX_CLUSTERS,            //  byte  AppNumOutClusters;
     69                  (cId_t *)SampleApp_ClusterList  //  byte *pAppOutClusterList;
     70          };
     71          

   \                                 In  segment XDATA_I, align 1, keep-with-next
     72          endPointDesc_t SampleApp_epDesc =
   \                     SampleApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for SampleApp_epDesc>`
   \   000006                REQUIRE __INIT_XDATA_I
     73              {
     74                  SAMPLEAPP_ENDPOINT,
     75                  &SampleApp_TaskID,
     76                  (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc,
     77                  noLatencyReqs};
     78          
     79          /*********************************************************************
     80           * TYPEDEFS
     81           */
     82          
     83          /*********************************************************************
     84           * GLOBAL VARIABLES
     85           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     86          devStates_t SampleApp_NwkState;
   \                     SampleApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     87          uint8 SampleApp_TaskID; // Task ID for internal task/event processing.
   \                     SampleApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     88          
     89          /*********************************************************************
     90           * EXTERNAL VARIABLES
     91           */
     92          
     93          /*********************************************************************
     94           * EXTERNAL FUNCTIONS
     95           */
     96          
     97          /*********************************************************************
     98           * LOCAL VARIABLES
     99           */
    100          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    101          static uint8 SampleApp_MsgID; //消息id
   \                     SampleApp_MsgID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    102          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    103          afAddrType_t SampleApp_P2P_DstAddr; //播类型
   \                     SampleApp_P2P_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    104          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    105          static uint8 SampleApp_RxBuf[SAMPLE_APP_RX_MAX + 1] = {0};
   \                     SampleApp_RxBuf:
   \   000000                DS 201
   \   0000C9                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    106          static uint16 SampleApp_RxLen = 0;
   \                     SampleApp_RxLen:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    107          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    108          uint8 onenet_login_ok = 0; //onenet注册成功 0:未注册，1：注册中　2：注册成功
   \                     onenet_login_ok:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    109          uint8 end_temp;            //终端的温度
   \                     end_temp:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    110          uint8 end_hum;             //终端的湿度
   \                     end_hum:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    111          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    112          uint8 end_light = 0;     //开发板区域亮度     亮0-127灭
   \                     end_light:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    113          uint8 end_led2 = 0;      //终端节点开发板led3状态     0灭 1亮
   \                     end_led2:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    114          uint8 cor_led3 = 0;      //协调器led3 0灭 1亮
   \                     cor_led3:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    115          uint8 end_obstacles = 0; //终端障碍物 0无障碍(输出高电平） 1有障碍(低电平)
   \                     end_obstacles:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    116          uint8 end_buzzer = 0;    //buzzer 0不响 1响起
   \                     end_buzzer:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    117          uint8 end_smoke = 0;     //烟雾浓度0-127 浓度越高电压越高5V
   \                     end_smoke:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    118          uint8 end_man = 0;       //人体传感器，有人输出高电平，没人输出低电平
   \                     end_man:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    119          #ifdef ZDO_COORDINATOR

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    120          signed char *g_mqtt_topics_set[5] = {NULL};
   \                     g_mqtt_topics_set:
   \   000000                DS 10
   \   00000A                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    121          u8 topics_buff[60] = {0};
   \                     topics_buff:
   \   000000                DS 60
   \   00003C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    122          u8 topics_post[100] = {0};  //发布的主题
   \                     topics_post:
   \   000000                DS 100
   \   000064                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    123          u8 mqtt_message[200] = {0}; //发布的消息
   \                     mqtt_message:
   \   000000                DS 200
   \   0000C8                REQUIRE __INIT_XDATA_Z
    124          #endif
    125          
    126          /*********************************************************************
    127           * LOCAL FUNCTIONS
    128           */
    129          
    130          static void SampleApp_ProcessMSGCmd(afIncomingMSGPacket_t *pkt);
    131          void SampleApp_CallBack(uint8 port, uint8 event);
    132          static void SampleApp_Send_P2P_Message(void);
    133          static void OneNet_publish_topic();
    134          void debug(uint8 *msg, ...);
    135          
    136          /*********************************************************************
    137           * @fn      SampleApp_Init
    138           *
    139           * @brief   This is called during OSAL tasks' initialization.
    140           *
    141           * @param   task_id - the Task ID assigned by OSAL.
    142           *
    143           * @return  none
    144           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    145          void SampleApp_Init(uint8 task_id)
   \                     SampleApp_Init:
    146          {
   \   000000   74F7         MOV       A,#-0x9
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV       A,#-0x6
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   E9           MOV       A,R1
   \   00000B   FE           MOV       R6,A
    147            halUARTCfg_t uartConfig;
    148          
    149            SampleApp_TaskID = task_id;
   \   00000C   90....       MOV       DPTR,#SampleApp_TaskID
   \   00000F   F0           MOVX      @DPTR,A
    150            SampleApp_NwkState = DEV_INIT;
   \   000010   90....       MOV       DPTR,#SampleApp_NwkState
   \   000013   7401         MOV       A,#0x1
   \   000015   F0           MOVX      @DPTR,A
    151          
    152            MT_UartInit();                  //串口初始化
                   ^
Warning[Pe223]: function "MT_UartInit" declared implicitly
   \   000016                ; Setup parameters for call to function MT_UartInit
   \   000016   12....       LCALL     `??MT_UartInit::?relay`; Banked call to: MT_UartInit
    153            MT_UartRegisterTaskID(task_id); //注册串口任务
                   ^
Warning[Pe223]: function "MT_UartRegisterTaskID" declared implicitly
   \   000019                ; Setup parameters for call to function MT_UartRegisterTaskID
   \   000019   EE           MOV       A,R6
   \   00001A   FA           MOV       R2,A
   \   00001B   7B00         MOV       R3,#0x0
   \   00001D   12....       LCALL     `??MT_UartRegisterTaskID::?relay`; Banked call to: MT_UartRegisterTaskID
    154            afRegister((endPointDesc_t *)&SampleApp_epDesc);
   \   000020                ; Setup parameters for call to function afRegister
   \   000020   7A..         MOV       R2,#SampleApp_epDesc & 0xff
   \   000022   7B..         MOV       R3,#(SampleApp_epDesc >> 8) & 0xff
   \   000024   12....       LCALL     `??afRegister::?relay`; Banked call to: afRegister
    155            RegisterForKeys(task_id);
   \   000027                ; Setup parameters for call to function RegisterForKeys
   \   000027   EE           MOV       A,R6
   \   000028   F9           MOV       R1,A
   \   000029   12....       LCALL     `??RegisterForKeys::?relay`; Banked call to: RegisterForKeys
    156          
    157          #ifdef ZDO_COORDINATOR
    158            //协调器初始化
    159          
    160            //逢蜂鸣器初始化
    161            //  P0SEL &= ~0x80;                 //设置P07为普通IO口
    162            //  P0DIR |= 0x80;                 //P07定义为输出口
    163            //
    164            //  //默认蜂鸣器不响
    165            //  P0_7=1;
    166          
    167            //初始化发布的主题
    168            sprintf(topics_post, "/post"); //"/sys/%s/%s/thing/event/property/post",ProductKey,DeviceName);
                           ^
Warning[Pe167]: argument of type "unsigned char *" is incompatible with
          parameter of type "char *"
   \   00002C                ; Setup parameters for call to function sprintf
   \   00002C   7C..         MOV       R4,#`?<Constant "/post">` & 0xff
   \   00002E   7D..         MOV       R5,#(`?<Constant "/post">` >> 8) & 0xff
   \   000030   7A..         MOV       R2,#topics_post & 0xff
   \   000032   7B..         MOV       R3,#(topics_post >> 8) & 0xff
   \   000034   12....       LCALL     `??sprintf::?relay`; Banked call to: sprintf
    169          
    170            //初始化订阅的主题
    171            sprintf(topics_buff, "/set"); //"/sys/%s/%s/thing/service/property/set",ProductKey,DeviceName);// /sys/a1sYYwS4kmH/mytestdev/thing/service/property/set
                           ^
Warning[Pe167]: argument of type "unsigned char *" is incompatible with
          parameter of type "char *"
   \   000037                ; Setup parameters for call to function sprintf
   \   000037   7C..         MOV       R4,#`?<Constant "/set">` & 0xff
   \   000039   7D..         MOV       R5,#(`?<Constant "/set">` >> 8) & 0xff
   \   00003B   7A..         MOV       R2,#topics_buff & 0xff
   \   00003D   7B..         MOV       R3,#(topics_buff >> 8) & 0xff
   \   00003F   12....       LCALL     `??sprintf::?relay`; Banked call to: sprintf
    172            g_mqtt_topics_set[0] = topics_buff;
                                        ^
Warning[Pe513]: a value of type "unsigned char *" cannot be assigned to an
          entity of type "signed char *"
   \   000042   90....       MOV       DPTR,#g_mqtt_topics_set
   \   000045   74..         MOV       A,#topics_buff & 0xff
   \   000047   F0           MOVX      @DPTR,A
   \   000048   A3           INC       DPTR
   \   000049   74..         MOV       A,#(topics_buff >> 8) & 0xff
   \   00004B   F0           MOVX      @DPTR,A
    173          
    174            //协调器广播给终端
    175            SampleApp_P2P_DstAddr.addrMode = (afAddrMode_t)AddrBroadcast; //广播模式
   \   00004C   90....       MOV       DPTR,#SampleApp_P2P_DstAddr + 8
   \   00004F   740F         MOV       A,#0xf
   \   000051   F0           MOVX      @DPTR,A
    176            SampleApp_P2P_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000052   A3           INC       DPTR
   \   000053   740B         MOV       A,#0xb
   \   000055   F0           MOVX      @DPTR,A
    177            SampleApp_P2P_DstAddr.addr.shortAddr = 0xFFFF; //发给终端
   \   000056   90....       MOV       DPTR,#SampleApp_P2P_DstAddr
   \   000059   74FF         MOV       A,#-0x1
   \   00005B   F0           MOVX      @DPTR,A
   \   00005C   A3           INC       DPTR
   \   00005D   F0           MOVX      @DPTR,A
    178          
    179            //目的地址端口号
    180            endPointDesc_t SampleApp_epDesc;
    181            SampleApp_epDesc.endPoint = SAMPLEAPP_ENDPOINT;
   \   00005E   85..82       MOV       DPL,?XSP + 0
   \   000061   85..83       MOV       DPH,?XSP + 1
   \   000064   740B         MOV       A,#0xb
   \   000066   F0           MOVX      @DPTR,A
    182            SampleApp_epDesc.task_id = &SampleApp_TaskID;
   \   000067   7401         MOV       A,#0x1
   \   000069   12....       LCALL     ?XSTACK_DISP0_8
   \   00006C   74..         MOV       A,#SampleApp_TaskID & 0xff
   \   00006E   F0           MOVX      @DPTR,A
   \   00006F   A3           INC       DPTR
   \   000070   74..         MOV       A,#(SampleApp_TaskID >> 8) & 0xff
   \   000072   F0           MOVX      @DPTR,A
    183            SampleApp_epDesc.simpleDesc = (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc;
   \   000073   7403         MOV       A,#0x3
   \   000075   12....       LCALL     ?XSTACK_DISP0_8
   \   000078   74..         MOV       A,#SampleApp_SimpleDesc & 0xff
   \   00007A   F0           MOVX      @DPTR,A
   \   00007B   A3           INC       DPTR
   \   00007C   74..         MOV       A,#(SampleApp_SimpleDesc >> 8) & 0xff
   \   00007E   F0           MOVX      @DPTR,A
    184            SampleApp_epDesc.latencyReq = noLatencyReqs;
   \   00007F   7405         MOV       A,#0x5
   \   000081   12....       LCALL     ?XSTACK_DISP0_8
   \   000084   E4           CLR       A
   \   000085   F0           MOVX      @DPTR,A
    185            afRegister(&SampleApp_epDesc);
   \   000086                ; Setup parameters for call to function afRegister
   \   000086   AA..         MOV       R2,?XSP + 0
   \   000088   AB..         MOV       R3,?XSP + 1
   \   00008A   12....       LCALL     `??afRegister::?relay`; Banked call to: afRegister
    186          
    187          #else
    188            //终端点播给协调器
    189            SampleApp_P2P_DstAddr.addrMode = (afAddrMode_t)Addr16Bit; //点播
    190            SampleApp_P2P_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
    191            SampleApp_P2P_DstAddr.addr.shortAddr = 0x0000; //发给协调器
    192                                                           //初始化相关的模块连接的引脚 P0_4_5 通用io 输出 检查拉低与否
    193            P0SEL &= 0xCF;                                 //    11001111
    194            P0DIR |= 0x00;                                 //0_5输入，无障碍物时被拉高      1输出    00010000
    195          
    196            //P2_0
    197            P2SEL &= ~1<<0; //通用io
    198            P2DIR &= ~1<<0; // 2_0 输入
    199            P2INP &= ~1<<0; //上拉/下拉
    200          #endif
    201          }
   \   00008D   7406         MOV       A,#0x6
   \   00008F                REQUIRE ?Subroutine0
   \   00008F                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL     ?DEALLOC_XSTACK8
   \   000003   7F01         MOV       R7,#0x1
   \   000005   02....       LJMP      ?BANKED_LEAVE_XDATA
    202          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    203          void SampleApp_HandleKeys(uint8 shift, uint8 keys)
   \                     SampleApp_HandleKeys:
    204          {
   \   000000   74F7         MOV       A,#-0x9
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV       A,#-0x2
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   EA           MOV       A,R2
    205            (void)shift; // Intentionally unreferenced parameter
    206          
    207          #if defined(ZDO_COORDINATOR)
    208          
    209            if (keys & HAL_KEY_SW_6) //key1
   \   00000B   A2E5         MOV       C,0xE0 /* A   */.5
   \   00000D   5015         JNC       ??SampleApp_HandleKeys_0
    210            {
    211              const signed char *g_mqtt_topics[] = {"mqtt_topic_test1"};
   \   00000F   90....       MOV       DPTR,#`?<Constant {&"mqtt_topic_test1"}>`
   \   000012   AC..         MOV       R4,?XSP + 0
   \   000014   AD..         MOV       R5,?XSP + 1
   \   000016   7402         MOV       A,#0x2
   \   000018   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    212              if (0 == mqtt_subscribe_topic(g_mqtt_topics, 1))
   \   00001B                ; Setup parameters for call to function mqtt_subscribe_topic
   \   00001B   7901         MOV       R1,#0x1
   \   00001D   AA..         MOV       R2,?XSP + 0
   \   00001F   AB..         MOV       R3,?XSP + 1
   \   000021   12....       LCALL     `??mqtt_subscribe_topic::?relay`; Banked call to: mqtt_subscribe_topic
    213              {
    214              }
    215            }
    216          
    217            if (keys & HAL_KEY_SW_1) //key2
    218            {
    219            }
    220          
    221          #endif
    222          }
   \                     ??SampleApp_HandleKeys_0:
   \   000024   7402         MOV       A,#0x2
   \   000026   80..         SJMP      ?Subroutine0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {&"mqtt_topic_test1"}>`:
   \   000000   ....         DW `?<Constant "mqtt_topic_test1">`
    223          
    224          /*********************************************************************
    225           * @fn      SampleApp_ProcessEvent
    226           *
    227           * @brief   Generic Application Task event processor.
    228           *
    229           * @param   task_id  - The OSAL assigned task ID.
    230           * @param   events   - Bit map of events to process.
    231           *
    232           * @return  Event flags of all unprocessed events.
    233           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    234          UINT16 SampleApp_ProcessEvent(uint8 task_id, UINT16 events)
   \                     SampleApp_ProcessEvent:
    235          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000   74F4         MOV       A,#-0xc
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV       A,R2
   \   000006   FE           MOV       R6,A
   \   000007   EB           MOV       A,R3
   \   000008   FF           MOV       R7,A
    236            (void)task_id; // Intentionally unreferenced parameter
    237          
    238            if (events & SYS_EVENT_MSG)
   \   000009   5480         ANL       A,#0x80
   \   00000B   7048         JNZ       ??SampleApp_ProcessEvent_0
    239            {
    240              afIncomingMSGPacket_t *MSGpkt;
    241          
    242              while ((MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive(SampleApp_TaskID)))
    243              {
    244                switch (MSGpkt->hdr.event)
    245                {
    246                case KEY_CHANGE:
    247                  SampleApp_HandleKeys(((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys);
    248                  break;
    249          
    250                case AF_INCOMING_MSG_CMD:
    251                  SampleApp_ProcessMSGCmd(MSGpkt);
    252                  break;
    253          
    254                case ZDO_STATE_CHANGE:
    255                  SampleApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
    256                  if ((SampleApp_NwkState == DEV_ZB_COORD) ||
    257                      (SampleApp_NwkState == DEV_ROUTER) || (SampleApp_NwkState == DEV_END_DEVICE))
    258                  {
    259                    //连网成功后，启动一个定时器
    260                    osal_start_timerEx(SampleApp_TaskID,
    261                                       SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    262                                       SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT);
    263                  }
    264                  else
    265                  {
    266                    // Device is no longer in the network
    267                  }
    268                  break;
    269          
    270                default:
    271                  break;
    272                }
    273          
    274                osal_msg_deallocate((uint8 *)MSGpkt);
    275              }
    276          
    277              return (events ^ SYS_EVENT_MSG);
    278            }
    279          
    280          #ifdef ZDO_COORDINATOR
    281          
    282            //定时器时间到
    283            if (events & SAMPLEAPP_SEND_PERIODIC_MSG_EVT)
   \   00000D   EA           MOV       A,R2
   \   00000E   A2E0         MOV       C,0xE0 /* A   */.0
   \   000010   4003         JC        $+5
   \   000012   02....       LJMP      ??SampleApp_ProcessEvent_1 & 0xFFFF
    284            {
    285              if (onenet_login_ok == 2)
   \   000015   90....       MOV       DPTR,#onenet_login_ok
   \   000018   E0           MOVX      A,@DPTR
   \   000019   6402         XRL       A,#0x2
   \   00001B   707B         JNZ       ??SampleApp_ProcessEvent_2
    286              {
    287                //如果接入onenet成功，启动心跳和发送数据定A器
    288          
    289                P1_1 = 0; //点亮D2
   \   00001D   C291         CLR       0x90.1
    290          
    291                // 启动心跳定时器，15秒一次
    292                osal_start_timerEx(SampleApp_TaskID, SAMPLEAPP_ONENET_HEART_BEAT_EVT, 15000);
   \   00001F                ; Setup parameters for call to function osal_start_timerEx
   \   00001F   7C98         MOV       R4,#-0x68
   \   000021   7D3A         MOV       R5,#0x3a
   \   000023   7A02         MOV       R2,#0x2
   \   000025   12....       LCALL     ?Subroutine10 & 0xFFFF
    293          
    294                // 启动发送数据定时器，5秒一次
    295                osal_start_timerEx(SampleApp_TaskID, SAMPLEAPP_ONENET_SEND_DATA_EVT, 5000);
   \                     ??CrossCallReturnLabel_15:
   \   000028                ; Setup parameters for call to function osal_start_timerEx
   \   000028   7C88         MOV       R4,#-0x78
   \   00002A   7D13         MOV       R5,#0x13
   \   00002C   7A04         MOV       R2,#0x4
   \   00002E   02....       LJMP      ??SampleApp_ProcessEvent_3 & 0xFFFF
    296              }
   \                     ??SampleApp_ProcessEvent_4:
   \   000031   A3           INC       DPTR
   \   000032   E0           MOVX      A,@DPTR
   \   000033   90....       MOV       DPTR,#SampleApp_NwkState
   \   000036   F0           MOVX      @DPTR,A
   \   000037   6409         XRL       A,#0x9
   \   000039   600A         JZ        ??SampleApp_ProcessEvent_5
   \   00003B   E0           MOVX      A,@DPTR
   \   00003C   6407         XRL       A,#0x7
   \   00003E   6005         JZ        ??SampleApp_ProcessEvent_5
   \   000040   E0           MOVX      A,@DPTR
   \   000041   6406         XRL       A,#0x6
   \   000043   7009         JNZ       ??CrossCallReturnLabel_16
   \                     ??SampleApp_ProcessEvent_5:
   \   000045                ; Setup parameters for call to function osal_start_timerEx
   \   000045   7CB8         MOV       R4,#-0x48
   \   000047   7D0B         MOV       R5,#0xb
   \   000049   7A01         MOV       R2,#0x1
   \   00004B   12....       LCALL     ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_16:
   \   00004E                ; Setup parameters for call to function osal_msg_deallocate
   \   00004E   AA..         MOV       R2,?V0
   \   000050   AB..         MOV       R3,?V1
   \   000052   12....       LCALL     `??osal_msg_deallocate::?relay`; Banked call to: osal_msg_deallocate
   \                     ??SampleApp_ProcessEvent_0:
   \   000055                ; Setup parameters for call to function osal_msg_receive
   \   000055   90....       MOV       DPTR,#SampleApp_TaskID
   \   000058   E0           MOVX      A,@DPTR
   \   000059   F9           MOV       R1,A
   \   00005A   12....       LCALL     `??osal_msg_receive::?relay`; Banked call to: osal_msg_receive
   \   00005D   8A..         MOV       ?V0,R2
   \   00005F   8B..         MOV       ?V1,R3
   \   000061   EA           MOV       A,R2
   \   000062   4B           ORL       A,R3
   \   000063   602B         JZ        ??SampleApp_ProcessEvent_6
   \   000065   8A82         MOV       DPL,R2
   \   000067   8B83         MOV       DPH,R3
   \   000069   E0           MOVX      A,@DPTR
   \   00006A   24E6         ADD       A,#-0x1a
   \   00006C   601D         JZ        ??SampleApp_ProcessEvent_7
   \   00006E   245A         ADD       A,#0x5a
   \   000070   6006         JZ        ??SampleApp_ProcessEvent_8
   \   000072   24EF         ADD       A,#-0x11
   \   000074   60BB         JZ        ??SampleApp_ProcessEvent_4
   \   000076   80D6         SJMP      ??CrossCallReturnLabel_16
   \                     ??SampleApp_ProcessEvent_8:
   \   000078                ; Setup parameters for call to function SampleApp_HandleKeys
   \   000078   A3           INC       DPTR
   \   000079   A3           INC       DPTR
   \   00007A   A3           INC       DPTR
   \   00007B   E0           MOVX      A,@DPTR
   \   00007C   FA           MOV       R2,A
   \   00007D   85..82       MOV       DPL,?V0
   \   000080   8B83         MOV       DPH,R3
   \   000082   A3           INC       DPTR
   \   000083   A3           INC       DPTR
   \   000084   E0           MOVX      A,@DPTR
   \   000085   F9           MOV       R1,A
   \   000086   12....       LCALL     `??SampleApp_HandleKeys::?relay`; Banked call to: SampleApp_HandleKeys
   \   000089   80C3         SJMP      ??CrossCallReturnLabel_16
   \                     ??SampleApp_ProcessEvent_7:
   \   00008B                ; Setup parameters for call to function SampleApp_ProcessMSGCmd
   \   00008B   12....       LCALL     `??SampleApp_ProcessMSGCmd::?relay`; Banked call to: SampleApp_ProcessMSGCmd
   \   00008E   80BE         SJMP      ??CrossCallReturnLabel_16
   \                     ??SampleApp_ProcessEvent_6:
   \   000090   EE           MOV       A,R6
   \   000091   FA           MOV       R2,A
   \   000092   EF           MOV       A,R7
   \   000093   6480         XRL       A,#0x80
   \   000095   02....       LJMP      ??SampleApp_ProcessEvent_9 & 0xFFFF
    297              else
    298              {
    299                onenet_login_ok = 1; //onenet注册成功 0:未注册，1：注册中　2：注册成功
   \                     ??SampleApp_ProcessEvent_2:
   \   000098   7401         MOV       A,#0x1
   \   00009A   12....       LCALL     ?Subroutine4 & 0xFFFF
    300                SampleApp_RxLen = 0;
    301          
    302                //如果没有接入onenet成功，重新发起接入
    303                OneNet_DevLink(); //接入onenet服务器
   \                     ??CrossCallReturnLabel_4:
   \   00009D                ; Setup parameters for call to function OneNet_DevLink
   \   00009D   12....       LCALL     `??OneNet_DevLink::?relay`; Banked call to: OneNet_DevLink
    304          
    305                //LED2闪，表示正在接入onenet
    306                HalLedBlink(HAL_LED_2, 5, 50, 500);
   \   0000A0                ; Setup parameters for call to function HalLedBlink
   \   0000A0   7CF4         MOV       R4,#-0xc
   \   0000A2   7D01         MOV       R5,#0x1
   \   0000A4   7B32         MOV       R3,#0x32
   \   0000A6   7A05         MOV       R2,#0x5
   \   0000A8   7902         MOV       R1,#0x2
   \   0000AA   12....       LCALL     `??HalLedBlink::?relay`; Banked call to: HalLedBlink
    307          
    308                // 每5秒尝试接入一次
    309                osal_start_timerEx(SampleApp_TaskID, SAMPLEAPP_SEND_PERIODIC_MSG_EVT, 5000);
   \   0000AD                ; Setup parameters for call to function osal_start_timerEx
   \   0000AD   7C88         MOV       R4,#-0x78
   \   0000AF   7D13         MOV       R5,#0x13
   \   0000B1   7A01         MOV       R2,#0x1
    310              }
    311          
    312              // return unprocessed events
    313              return (events ^ SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
    314            }
   \                     ??SampleApp_ProcessEvent_3:
   \   0000B3   12....       LCALL     ?Subroutine6 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   0000B6   6401         XRL       A,#0x1
   \   0000B8   02....       LJMP      ??SampleApp_ProcessEvent_10 & 0xFFFF
    315          
    316            //心跳定时器时间到
    317            if (events & SAMPLEAPP_ONENET_HEART_BEAT_EVT)
   \                     ??SampleApp_ProcessEvent_1:
   \   0000BB   5402         ANL       A,#0x2
   \   0000BD   6018         JZ        ??SampleApp_ProcessEvent_11
    318            {
    319              if (onenet_login_ok == 2)
   \   0000BF   90....       MOV       DPTR,#onenet_login_ok
   \   0000C2   E0           MOVX      A,@DPTR
   \   0000C3   6402         XRL       A,#0x2
   \   0000C5   7003         JNZ       ??SampleApp_ProcessEvent_12
    320              {
    321                //发送心跳
    322                onenet_mqtt_send_heart();
   \   0000C7                ; Setup parameters for call to function onenet_mqtt_send_heart
   \   0000C7   12....       LCALL     `??onenet_mqtt_send_heart::?relay`; Banked call to: onenet_mqtt_send_heart
    323              }
    324          
    325              // 启动心跳定时器，15秒一次
    326              osal_start_timerEx(SampleApp_TaskID, SAMPLEAPP_ONENET_HEART_BEAT_EVT, 15000);
   \                     ??SampleApp_ProcessEvent_12:
   \   0000CA                ; Setup parameters for call to function osal_start_timerEx
   \   0000CA   7C98         MOV       R4,#-0x68
   \   0000CC   7D3A         MOV       R5,#0x3a
   \   0000CE   7A02         MOV       R2,#0x2
   \   0000D0   12....       LCALL     ?Subroutine6 & 0xFFFF
    327          
    328              // return unprocessed events
    329              return (events ^ SAMPLEAPP_ONENET_HEART_BEAT_EVT);
    330            }
   \                     ??CrossCallReturnLabel_7:
   \   0000D3   6402         XRL       A,#0x2
   \   0000D5   806F         SJMP      ??SampleApp_ProcessEvent_10
    331          
    332            //发送数据定时器时间到
    333            if (events & SAMPLEAPP_ONENET_SEND_DATA_EVT)
   \                     ??SampleApp_ProcessEvent_11:
   \   0000D7   EA           MOV       A,R2
   \   0000D8   5404         ANL       A,#0x4
   \   0000DA   606F         JZ        ??SampleApp_ProcessEvent_13
    334            {
    335              if (onenet_login_ok == 2)
   \   0000DC   90....       MOV       DPTR,#onenet_login_ok
   \   0000DF   E0           MOVX      A,@DPTR
   \   0000E0   6402         XRL       A,#0x2
   \   0000E2   7057         JNZ       ??SampleApp_ProcessEvent_14
    336              {
    337                //发送温湿度数据到onenet
    338                //    OneNet_SendData(end_temp, end_hum);
    339          
    340                sprintf(mqtt_message,
                               ^
Warning[Pe167]: argument of type "unsigned char *" is incompatible with
          parameter of type "char *"
    341                        "{\"method\":\"thing.service.property.set\",\"id\":\"630262306\",\"params\":{\
    342                      \"temp\":%d,\
    343                      \"hum\":%d,\
    344                         \"end_light\":%d,\
    345                        \"end_led2\":%d,\
    346          			  \"end_obstacles\":%d,\
    347                    \"end_smoke\":%d,\
    348                    \"end_man\":%d }\
    349                  }",
    350                        end_temp,
    351                        end_hum,
    352                        end_light,
    353                        end_led2,
    354                        end_obstacles,
    355                        end_smoke,
    356                        end_man);
   \   0000E4                ; Setup parameters for call to function sprintf
   \   0000E4   90....       MOV       DPTR,#end_man
   \   0000E7   12....       LCALL     ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_11:
   \   0000EA   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000ED   90....       MOV       DPTR,#end_smoke
   \   0000F0   12....       LCALL     ??Subroutine12_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_20:
   \   0000F3   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000F6   90....       MOV       DPTR,#end_obstacles
   \   0000F9   12....       LCALL     ??Subroutine12_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_21:
   \   0000FC   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000FF   90....       MOV       DPTR,#end_led2
   \   000102   12....       LCALL     ??Subroutine12_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_22:
   \   000105   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000108   90....       MOV       DPTR,#end_light
   \   00010B   12....       LCALL     ??Subroutine12_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_23:
   \   00010E   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000111   12....       LCALL     ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   000114   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000117   90....       MOV       DPTR,#end_temp
   \   00011A   12....       LCALL     ??Subroutine12_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   00011D   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000120   7C..         MOV       R4,#`?<Constant "{\\"method\\":\\"thing.serv...">` & 0xff
   \   000122   7D..         MOV       R5,#(`?<Constant "{\\"method\\":\\"thing.serv...">` >> 8) & 0xff
   \   000124   7A..         MOV       R2,#mqtt_message & 0xff
   \   000126   7B..         MOV       R3,#(mqtt_message >> 8) & 0xff
   \   000128   12....       LCALL     `??sprintf::?relay`; Banked call to: sprintf
   \   00012B   740E         MOV       A,#0xe
   \   00012D   12....       LCALL     ?DEALLOC_XSTACK8
    357          
    358                //发布主题
    359                mqtt_publish_topic(topics_post, mqtt_message);
                                          ^
Warning[Pe167]: argument of type "unsigned char *" is incompatible with
          parameter of type "char const *"

        mqtt_publish_topic(topics_post, mqtt_message);
                                        ^
"C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c",359  Warning[Pe167]: 
          argument of type "unsigned char *" is incompatible with parameter of
          type "char const *"
   \   000130                ; Setup parameters for call to function mqtt_publish_topic
   \   000130   7C..         MOV       R4,#mqtt_message & 0xff
   \   000132   7D..         MOV       R5,#(mqtt_message >> 8) & 0xff
   \   000134   7A..         MOV       R2,#topics_post & 0xff
   \   000136   7B..         MOV       R3,#(topics_post >> 8) & 0xff
   \   000138   12....       LCALL     `??mqtt_publish_topic::?relay`; Banked call to: mqtt_publish_topic
    360          
    361                //  OneNet_publish_topic();
    362              }
    363          
    364              // 启动发送数据定时器，5秒一次
    365              osal_start_timerEx(SampleApp_TaskID, SAMPLEAPP_ONENET_SEND_DATA_EVT, 5000);
   \                     ??SampleApp_ProcessEvent_14:
   \   00013B                ; Setup parameters for call to function osal_start_timerEx
   \   00013B   7C88         MOV       R4,#-0x78
   \   00013D   7D13         MOV       R5,#0x13
   \   00013F   7A04         MOV       R2,#0x4
   \   000141   12....       LCALL     ?Subroutine6 & 0xFFFF
    366          
    367              // return unprocessed events
    368              return (events ^ SAMPLEAPP_ONENET_SEND_DATA_EVT);
    369            }
   \                     ??CrossCallReturnLabel_8:
   \   000144   6404         XRL       A,#0x4
   \                     ??SampleApp_ProcessEvent_10:
   \   000146   FA           MOV       R2,A
   \   000147   EF           MOV       A,R7
   \                     ??SampleApp_ProcessEvent_9:
   \   000148   FB           MOV       R3,A
   \   000149   8004         SJMP      ??SampleApp_ProcessEvent_15
    370          
    371          #else
    372          
    373            //定时器时间到
    374            if (events & SAMPLEAPP_SEND_PERIODIC_MSG_EVT)
    375            {
    376          
    377              // DHT11采集
    378              SampleApp_Send_P2P_Message();
    379          
    380              // Setup to send message again in normal period (+ a little jitter)
    381              osal_start_timerEx(SampleApp_TaskID, SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    382                                 (SAMPLEAPP_SEND_PERIODIC_MSG_TIMEOUT + (osal_rand() & 0x00FF)));
    383          
    384              // return unprocessed events
    385              return (events ^ SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
    386            }
    387          
    388          #endif
    389          
    390            return (0); // Discard unknown events.
   \                     ??SampleApp_ProcessEvent_13:
   \   00014B   7A00         MOV       R2,#0x0
   \   00014D   7B00         MOV       R3,#0x0
   \                     ??SampleApp_ProcessEvent_15:
   \   00014F                REQUIRE ?Subroutine1
   \   00014F                REQUIRE _A_P1
   \   00014F                ; // Fall through to label ?Subroutine1
    391          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F04         MOV       R7,#0x4
   \   000002   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   12....       LCALL     ?Subroutine10 & 0xFFFF
   \                     ??CrossCallReturnLabel_17:
   \   000003   EE           MOV       A,R6
   \   000004   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   7B00         MOV       R3,#0x0
   \   000002   90....       MOV       DPTR,#SampleApp_TaskID
   \   000005   E0           MOVX      A,@DPTR
   \   000006   F9           MOV       R1,A
   \   000007   12....       LCALL     `??osal_start_timerEx::?relay`; Banked call to: osal_start_timerEx
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   F5..         MOV       ?V0,A
   \   000003   75..00       MOV       ?V1,#0x0
   \   000006   78..         MOV       R0,#?V0
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   90....       MOV       DPTR,#end_hum
   \   000003                REQUIRE ??Subroutine12_0
   \   000003                ; // Fall through to label ??Subroutine12_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine12_0:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   F5..         MOV       ?V0,A
   \   000003   78..         MOV       R0,#?V0
   \   000005   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   F0           MOVX      @DPTR,A
   \   000001   90....       MOV       DPTR,#SampleApp_RxLen
   \   000004   E4           CLR       A
   \   000005   F0           MOVX      @DPTR,A
   \   000006   A3           INC       DPTR
   \   000007   F0           MOVX      @DPTR,A
   \   000008   22           RET
    392          
    393          /*********************************************************************
    394           * @fn      SerialApp_ProcessMSGCmd
    395           *
    396           * @brief   Data message processor callback. This function processes
    397           *          any incoming data - probably from other devices. Based
    398           *          on the cluster ID, perform the intended action.
    399           *
    400           * @param   pkt - pointer to the incoming message packet
    401           *
    402           * @return  TRUE if the 'pkt' parameter is being used and will be freed later,
    403           *          FALSE otherwise.
    404           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    405          void SampleApp_ProcessMSGCmd(afIncomingMSGPacket_t *pkt)
   \                     SampleApp_ProcessMSGCmd:
    406          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000   74F5         MOV       A,#-0xb
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 148
   \   000005   746C         MOV       A,#0x6c
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   EA           MOV       A,R2
   \   00000B   FE           MOV       R6,A
   \   00000C   EB           MOV       A,R3
   \   00000D   FF           MOV       R7,A
    407            uint8 buff[20] = {0};
   \   00000E   90....       MOV       DPTR,#`?<Constant {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0`
   \   000011   AC..         MOV       R4,?XSP + 0
   \   000013   AD..         MOV       R5,?XSP + 1
   \   000015   7414         MOV       A,#0x14
   \   000017   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    408          
    409            switch (pkt->clusterId)
   \   00001A   8A82         MOV       DPL,R2
   \   00001C   8B83         MOV       DPH,R3
   \   00001E   A3           INC       DPTR
   \   00001F   A3           INC       DPTR
   \   000020   A3           INC       DPTR
   \   000021   A3           INC       DPTR
   \   000022   E0           MOVX      A,@DPTR
   \   000023   F5..         MOV       ?V0,A
   \   000025   A3           INC       DPTR
   \   000026   E0           MOVX      A,@DPTR
   \   000027   F5..         MOV       ?V1,A
   \   000029   78..         MOV       R0,#?V0
   \   00002B   12....       LCALL     ?US_SWITCH_DENSE
   \                     `?<Jumptable for SampleApp_ProcessMSGCmd>_0`:
   \   00002E   0100         DW        1
   \   000030   03           DB        3
   \   000031   ....         DW        ??SampleApp_ProcessMSGCmd_0
   \   000033   ....         DW        ??SampleApp_ProcessMSGCmd_1
   \   000035   ....         DW        ??SampleApp_ProcessMSGCmd_0
   \   000037   ....         DW        ??SampleApp_ProcessMSGCmd_0
   \   000039   ....         DW        ??SampleApp_ProcessMSGCmd_2
    410            {
    411            // 接收终端上传的温度数据
    412            case SAMPLEAPP_P2P_CLUSTERID:
    413          #ifdef ZDO_COORDINATOR
    414            {
    415              end_temp = pkt->cmd.Data[0]; //终端温度
   \                     ??SampleApp_ProcessMSGCmd_1:
   \   00003B   EA           MOV       A,R2
   \   00003C   2422         ADD       A,#0x22
   \   00003E   F8           MOV       R0,A
   \   00003F   E4           CLR       A
   \   000040   3F           ADDC      A,R7
   \   000041   F9           MOV       R1,A
   \   000042   8882         MOV       DPL,R0
   \   000044   F583         MOV       DPH,A
   \   000046   12....       LCALL     ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_9:
   \   000049   E0           MOVX      A,@DPTR
   \   00004A   90....       MOV       DPTR,#end_temp
   \   00004D   F0           MOVX      @DPTR,A
    416              end_hum = pkt->cmd.Data[1];  //终端湿度
   \   00004E   8882         MOV       DPL,R0
   \   000050   8983         MOV       DPH,R1
   \   000052   12....       LCALL     ?Subroutine7 & 0xFFFF
   \                     ??CrossCallReturnLabel_10:
   \   000055   A3           INC       DPTR
   \   000056   E0           MOVX      A,@DPTR
   \   000057   90....       MOV       DPTR,#end_hum
   \   00005A   12....       LCALL     ?Subroutine3 & 0xFFFF
    417          
    418              end_light = pkt->cmd.Data[2];     //终端亮度
   \                     ??CrossCallReturnLabel_2:
   \   00005D   E0           MOVX      A,@DPTR
   \   00005E   90....       MOV       DPTR,#end_light
   \   000061   12....       LCALL     ?Subroutine3 & 0xFFFF
    419              end_led2 = pkt->cmd.Data[3];      //led2
   \                     ??CrossCallReturnLabel_3:
   \   000064   A3           INC       DPTR
   \   000065   E0           MOVX      A,@DPTR
   \   000066   90....       MOV       DPTR,#end_led2
   \   000069   12....       LCALL     ?Subroutine2 & 0xFFFF
    420              end_obstacles = pkt->cmd.Data[4]; //障碍物
   \                     ??CrossCallReturnLabel_0:
   \   00006C   E0           MOVX      A,@DPTR
   \   00006D   90....       MOV       DPTR,#end_obstacles
   \   000070   12....       LCALL     ?Subroutine2 & 0xFFFF
    421              end_smoke = pkt->cmd.Data[5];     //烟雾
   \                     ??CrossCallReturnLabel_1:
   \   000073   A3           INC       DPTR
   \   000074   E0           MOVX      A,@DPTR
   \   000075   90....       MOV       DPTR,#end_smoke
   \   000078   F0           MOVX      @DPTR,A
    422              end_man = pkt->cmd.Data[6];       //人体
   \   000079   8882         MOV       DPL,R0
   \   00007B   8983         MOV       DPH,R1
   \   00007D   E0           MOVX      A,@DPTR
   \   00007E   F8           MOV       R0,A
   \   00007F   A3           INC       DPTR
   \   000080   E0           MOVX      A,@DPTR
   \   000081   C8           XCH       A,R0
   \   000082   2406         ADD       A,#0x6
   \   000084   F582         MOV       DPL,A
   \   000086   E4           CLR       A
   \   000087   38           ADDC      A,R0
   \   000088   F583         MOV       DPH,A
   \   00008A   E0           MOVX      A,@DPTR
   \   00008B   90....       MOV       DPTR,#end_man
   \   00008E   F0           MOVX      @DPTR,A
    423              //cor_led3 = !cor_led3;
    424              sprintf(buff, "T:%d", end_temp);
                             ^
Warning[Pe167]: argument of type "uint8 *" is incompatible with parameter of
          type "char *"
   \   00008F                ; Setup parameters for call to function sprintf
   \   00008F   90....       MOV       DPTR,#end_temp
   \   000092   12....       LCALL     ?Subroutine8 & 0xFFFF
   \                     ??CrossCallReturnLabel_12:
   \   000095   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000098   7C..         MOV       R4,#`?<Constant "T:%d">` & 0xff
   \   00009A   7D..         MOV       R5,#(`?<Constant "T:%d">` >> 8) & 0xff
   \   00009C   7402         MOV       A,#0x2
   \   00009E   12....       LCALL     ?XSTACK_DISP101_8
   \   0000A1   12....       LCALL     `??sprintf::?relay`; Banked call to: sprintf
   \   0000A4   7402         MOV       A,#0x2
   \   0000A6   12....       LCALL     ?DEALLOC_XSTACK8
    425              HalLcdWriteString(buff, HAL_LCD_LINE_3); //LCD显示
                                       ^
Warning[Pe167]: argument of type "uint8 *" is incompatible with parameter of
          type "char *"
   \   0000A9                ; Setup parameters for call to function HalLcdWriteString
   \   0000A9   7903         MOV       R1,#0x3
   \   0000AB   AA..         MOV       R2,?XSP + 0
   \   0000AD   AB..         MOV       R3,?XSP + 1
   \   0000AF   12....       LCALL     `??HalLcdWriteString::?relay`; Banked call to: HalLcdWriteString
    426          
    427              sprintf(buff, "H:%d", end_hum);
                             ^
Warning[Pe167]: argument of type "uint8 *" is incompatible with parameter of
          type "char *"
   \   0000B2                ; Setup parameters for call to function sprintf
   \   0000B2   12....       LCALL     ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_26:
   \   0000B5   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000B8   7C..         MOV       R4,#`?<Constant "H:%d">` & 0xff
   \   0000BA   7D..         MOV       R5,#(`?<Constant "H:%d">` >> 8) & 0xff
   \   0000BC   7402         MOV       A,#0x2
   \   0000BE   12....       LCALL     ?XSTACK_DISP101_8
   \   0000C1   12....       LCALL     `??sprintf::?relay`; Banked call to: sprintf
   \   0000C4   7402         MOV       A,#0x2
   \   0000C6   12....       LCALL     ?DEALLOC_XSTACK8
    428              HalLcdWriteString(buff, HAL_LCD_LINE_4); //LCD显示
                                       ^
Warning[Pe167]: argument of type "uint8 *" is incompatible with parameter of
          type "char *"
   \   0000C9                ; Setup parameters for call to function HalLcdWriteString
   \   0000C9   7904         MOV       R1,#0x4
   \   0000CB   AA..         MOV       R2,?XSP + 0
   \   0000CD   AB..         MOV       R3,?XSP + 1
   \   0000CF   12....       LCALL     `??HalLcdWriteString::?relay`; Banked call to: HalLcdWriteString
    429            }
    430          #endif
    431            break;
   \   0000D2   02....       LJMP      ??SampleApp_ProcessMSGCmd_0 & 0xFFFF
    432          
    433            case SAMPLEAPP_PERIODIC_CLUSTERID:
    434          
    435              break;
    436            case SAMPLEAPP_CTE_CLUSTERID: //coor to end 终端进行命令解析和处理
    437              char buf[128];
                     ^
Warning[Pe1072]: a declaration cannot have a label
    438              osal_memset(buf, '\0', 128);
   \                     ??SampleApp_ProcessMSGCmd_2:
   \   0000D5                ; Setup parameters for call to function osal_memset
   \   0000D5   7C80         MOV       R4,#-0x80
   \   0000D7   7D00         MOV       R5,#0x0
   \   0000D9   7900         MOV       R1,#0x0
   \   0000DB   7414         MOV       A,#0x14
   \   0000DD   12....       LCALL     ?XSTACK_DISP101_8
   \   0000E0   12....       LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
    439              osal_memcpy(buf, pkt->cmd.Data, pkt->cmd.DataLength); //复制到缓冲区
   \   0000E3                ; Setup parameters for call to function osal_memcpy
   \   0000E3   EE           MOV       A,R6
   \   0000E4   2422         ADD       A,#0x22
   \   0000E6   F582         MOV       DPL,A
   \   0000E8   E4           CLR       A
   \   0000E9   3F           ADDC      A,R7
   \   0000EA   F583         MOV       DPH,A
   \   0000EC   E0           MOVX      A,@DPTR
   \   0000ED   F5..         MOV       ?V0,A
   \   0000EF   A3           INC       DPTR
   \   0000F0   E0           MOVX      A,@DPTR
   \   0000F1   F5..         MOV       ?V1,A
   \   0000F3   75..00       MOV       ?V2,#0x0
   \   0000F6   78..         MOV       R0,#?V0
   \   0000F8   12....       LCALL     ?PUSH_XSTACK_I_THREE
   \   0000FB   EE           MOV       A,R6
   \   0000FC   2420         ADD       A,#0x20
   \   0000FE   F582         MOV       DPL,A
   \   000100   E4           CLR       A
   \   000101   3F           ADDC      A,R7
   \   000102   F583         MOV       DPH,A
   \   000104   E0           MOVX      A,@DPTR
   \   000105   FC           MOV       R4,A
   \   000106   A3           INC       DPTR
   \   000107   E0           MOVX      A,@DPTR
   \   000108   FD           MOV       R5,A
   \   000109   7417         MOV       A,#0x17
   \   00010B   12....       LCALL     ?XSTACK_DISP101_8
   \   00010E   12....       LCALL     `??osal_memcpy::?relay`; Banked call to: osal_memcpy
   \   000111   7403         MOV       A,#0x3
   \   000113   12....       LCALL     ?DEALLOC_XSTACK8
    440              HalUARTWrite(0, buf, osal_strlen(buf));               //串口输出提示信息
                                     ^
Warning[Pe167]: argument of type "char *" is incompatible with parameter of
          type "uint8 *"
   \   000116                ; Setup parameters for call to function osal_strlen
   \   000116   7414         MOV       A,#0x14
   \   000118   12....       LCALL     ?XSTACK_DISP101_8
   \   00011B   12....       LCALL     `??osal_strlen::?relay`; Banked call to: osal_strlen
   \   00011E   8A..         MOV       ?V0,R2
   \   000120   8B..         MOV       ?V1,R3
   \   000122   AC..         MOV       R4,?V0
   \   000124   AD..         MOV       R5,?V1
   \   000126                ; Setup parameters for call to function HalUARTWrite
   \   000126   7414         MOV       A,#0x14
   \   000128   12....       LCALL     ?XSTACK_DISP101_8
   \   00012B   7900         MOV       R1,#0x0
   \   00012D   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    441              HalUARTWrite(0, "\r\n", 2);                           //串口输出提示信息
   \   000130                ; Setup parameters for call to function HalUARTWrite
   \   000130   7C02         MOV       R4,#0x2
   \   000132   7D00         MOV       R5,#0x0
   \   000134   7A..         MOV       R2,#`?<Constant "\\r\\n">` & 0xff
   \   000136   7B..         MOV       R3,#(`?<Constant "\\r\\n">` >> 8) & 0xff
   \   000138   7900         MOV       R1,#0x0
   \   00013A   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    442          
    443              if (strstr(buf, "D2:0"))
   \   00013D                ; Setup parameters for call to function strstr
   \   00013D   7C..         MOV       R4,#`?<Constant "D2:0">` & 0xff
   \   00013F   7D..         MOV       R5,#(`?<Constant "D2:0">` >> 8) & 0xff
   \   000141   7414         MOV       A,#0x14
   \   000143   12....       LCALL     ?XSTACK_DISP101_8
   \   000146   12....       LCALL     `??strstr::?relay`; Banked call to: strstr
   \   000149   EA           MOV       A,R2
   \   00014A   4B           ORL       A,R3
   \   00014B   6004         JZ        ??SampleApp_ProcessMSGCmd_3
    444                HalLedSet(HAL_LED_2, HAL_LED_MODE_OFF); //LED2
   \   00014D                ; Setup parameters for call to function HalLedSet
   \   00014D   7A00         MOV       R2,#0x0
   \   00014F   8012         SJMP      ??SampleApp_ProcessMSGCmd_4
    445              else if (strstr(buf, "D2:1"))
   \                     ??SampleApp_ProcessMSGCmd_3:
   \   000151                ; Setup parameters for call to function strstr
   \   000151   7C..         MOV       R4,#`?<Constant "D2:1">` & 0xff
   \   000153   7D..         MOV       R5,#(`?<Constant "D2:1">` >> 8) & 0xff
   \   000155   7414         MOV       A,#0x14
   \   000157   12....       LCALL     ?XSTACK_DISP101_8
   \   00015A   12....       LCALL     `??strstr::?relay`; Banked call to: strstr
   \   00015D   EA           MOV       A,R2
   \   00015E   4B           ORL       A,R3
   \   00015F   6007         JZ        ??SampleApp_ProcessMSGCmd_5
    446                HalLedSet(HAL_LED_2, HAL_LED_MODE_ON); //LED2
   \   000161                ; Setup parameters for call to function HalLedSet
   \   000161   7A01         MOV       R2,#0x1
   \                     ??SampleApp_ProcessMSGCmd_4:
   \   000163   7902         MOV       R1,#0x2
   \   000165   12....       LCALL     `??HalLedSet::?relay`; Banked call to: HalLedSet
    447          
    448              // 蜂鸣器改为烟雾检测 P0_4
    449              // if (strstr(buf, "B:1"))
    450              //   P0_4 = 0;
    451              // else if (strstr(buf, "B:0"))
    452              //   P0_4 = 1;
    453          
    454              osal_memset(buf, '\0', 128);
   \                     ??SampleApp_ProcessMSGCmd_5:
   \   000168                ; Setup parameters for call to function osal_memset
   \   000168   7C80         MOV       R4,#-0x80
   \   00016A   7D00         MOV       R5,#0x0
   \   00016C   7900         MOV       R1,#0x0
   \   00016E   7414         MOV       A,#0x14
   \   000170   12....       LCALL     ?XSTACK_DISP101_8
   \   000173   12....       LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
    455              break;
    456            default:
    457              break;
    458            }
    459          }
   \                     ??SampleApp_ProcessMSGCmd_0:
   \   000176   7494         MOV       A,#-0x6c
   \   000178   12....       LCALL     ?DEALLOC_XSTACK8
   \   00017B   7F03         MOV       R7,#0x3
   \   00017D   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   12....       LCALL     ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_18:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   E0           MOVX      A,@DPTR
   \   000001   FA           MOV       R2,A
   \   000002   A3           INC       DPTR
   \   000003   E0           MOVX      A,@DPTR
   \   000004   F583         MOV       DPH,A
   \   000006   8A82         MOV       DPL,R2
   \   000008   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL     ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_13:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   F0           MOVX      @DPTR,A
   \   000001   8882         MOV       DPL,R0
   \   000003   8983         MOV       DPH,R1
   \   000005   12....       LCALL     ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_19:
   \   000008   A3           INC       DPTR
   \   000009   A3           INC       DPTR
   \   00000A   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   12....       LCALL     ?Subroutine9 & 0xFFFF
   \                     ??CrossCallReturnLabel_14:
   \   000003   A3           INC       DPTR
   \   000004   A3           INC       DPTR
   \   000005   22           RET
    460          
    461          #ifdef ZDO_COORDINATOR
    462          
    463          //发送MQTT数据

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    464          void ESP8266_SendData(char *buff, int len)
   \                     ESP8266_SendData:
    465          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    466            if (len == 0)
   \   000004   EC           MOV       A,R4
   \   000005   4D           ORL       A,R5
   \   000006   6005         JZ        ??ESP8266_SendData_0
    467              return;
    468          
    469            HalUARTWrite(0, buff, len);
                                   ^
Warning[Pe167]: argument of type "char *" is incompatible with parameter of
          type "uint8 *"
   \   000008                ; Setup parameters for call to function HalUARTWrite
   \   000008   7900         MOV       R1,#0x0
   \   00000A   12....       LCALL     `??HalUARTWrite::?relay`; Banked call to: HalUARTWrite
    470          }
   \                     ??ESP8266_SendData_0:
   \   00000D   D083         POP       DPH
   \   00000F   D082         POP       DPL
   \   000011   02....       LJMP      ?BRET
    471          
    472          //接收到下发命令，或者接收到订阅的消息
    473          //topic:收到的主题
    474          //cmd::主题对应的内容

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    475          void mqtt_rx(uint8 *topic, uint8 *cmd)
   \                     mqtt_rx:
    476          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000   74F4         MOV       A,#-0xc
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 8
   \   000005   74F8         MOV       A,#-0x8
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
   \   00000A   EC           MOV       A,R4
   \   00000B   FE           MOV       R6,A
   \   00000C   ED           MOV       A,R5
   \   00000D   FF           MOV       R7,A
    477            char *ptr_led3_on = NULL;
    478            char *ptr_led3_off = NULL;
    479          
    480            char *this_topic = NULL;
    481            //控制命令格式
    482            char uartbuf[] = {'D', '2', ':', ' ',
    483                              'B', ':', ' ', '\0'};
   \   00000E   90....       MOV       DPTR,#`?<Constant {68, 50, 58, 32, 66, 58, 32, 0}>`
   \   000011   AC..         MOV       R4,?XSP + 0
   \   000013   AD..         MOV       R5,?XSP + 1
   \   000015   7408         MOV       A,#0x8
   \   000017   12....       LCALL     ?MOVE_LONG8_XDATA_XDATA
    484            //协调器收到数据后
    485            //根据设计决定数据如何处理
    486          
    487            if (topic == NULL || cmd == NULL)
   \   00001A   EA           MOV       A,R2
   \   00001B   4B           ORL       A,R3
   \   00001C   6004         JZ        ??mqtt_rx_0
   \   00001E   EE           MOV       A,R6
   \   00001F   4F           ORL       A,R7
   \   000020   7003         JNZ       ??mqtt_rx_1
    488              return;
   \                     ??mqtt_rx_0:
   \   000022   02....       LJMP      ??mqtt_rx_2 & 0xFFFF
    489          
    490            //我们只关心内容，即只关心CMD，不处理主题
    491          
    492            ptr_led3_on = strstr((char *)cmd, "\"led\":1");
   \                     ??mqtt_rx_1:
   \   000025                ; Setup parameters for call to function strstr
   \   000025   7C..         MOV       R4,#`?<Constant "\\"led\\":1">` & 0xff
   \   000027   7D..         MOV       R5,#(`?<Constant "\\"led\\":1">` >> 8) & 0xff
   \   000029   EE           MOV       A,R6
   \   00002A   FA           MOV       R2,A
   \   00002B   EF           MOV       A,R7
   \   00002C   FB           MOV       R3,A
   \   00002D   12....       LCALL     `??strstr::?relay`; Banked call to: strstr
   \   000030   8A..         MOV       ?V0,R2
   \   000032   8B..         MOV       ?V1,R3
    493            ptr_led3_off = strstr((char *)cmd, "\"led\":0");
   \   000034                ; Setup parameters for call to function strstr
   \   000034   7C..         MOV       R4,#`?<Constant "\\"led\\":0">` & 0xff
   \   000036   7D..         MOV       R5,#(`?<Constant "\\"led\\":0">` >> 8) & 0xff
   \   000038   EE           MOV       A,R6
   \   000039   FA           MOV       R2,A
   \   00003A   EF           MOV       A,R7
   \   00003B   FB           MOV       R3,A
   \   00003C   12....       LCALL     `??strstr::?relay`; Banked call to: strstr
   \   00003F   8B..         MOV       ?V3,R3
   \   000041   A9..         MOV       R1,?V3
    494          
    495            if (ptr_led3_on != NULL)
   \   000043   E5..         MOV       A,?V0
   \   000045   45..         ORL       A,?V1
   \   000047   6011         JZ        ??mqtt_rx_3
    496            {
    497              // coor led3
    498              //P1_4 = 0; //D3亮
    499              //cor_led3 = 1;
    500              uartbuf[3] = '1';
   \   000049   7403         MOV       A,#0x3
   \   00004B   12....       LCALL     ?XSTACK_DISP0_8
   \   00004E   7431         MOV       A,#0x31
   \   000050   F0           MOVX      @DPTR,A
    501              uartbuf[6] = '1';
   \   000051   7406         MOV       A,#0x6
   \   000053   12....       LCALL     ?XSTACK_DISP0_8
   \   000056   7431         MOV       A,#0x31
   \   000058   8013         SJMP      ??mqtt_rx_4
    502            }
    503            else if (ptr_led3_off != NULL)
   \                     ??mqtt_rx_3:
   \   00005A   EA           MOV       A,R2
   \   00005B   49           ORL       A,R1
   \   00005C   6010         JZ        ??mqtt_rx_5
    504            {
    505              // coor led3
    506              //P1_4 = 1; //D3灭
    507              //cor_led3 = 0;
    508              uartbuf[3] = '0';
   \   00005E   7403         MOV       A,#0x3
   \   000060   12....       LCALL     ?XSTACK_DISP0_8
   \   000063   7430         MOV       A,#0x30
   \   000065   F0           MOVX      @DPTR,A
    509              uartbuf[6] = '0';
   \   000066   7406         MOV       A,#0x6
   \   000068   12....       LCALL     ?XSTACK_DISP0_8
   \   00006B   7430         MOV       A,#0x30
   \                     ??mqtt_rx_4:
   \   00006D   F0           MOVX      @DPTR,A
    510            }
    511            HalLedBlink(HAL_LED_1, 5, 50, 500);
   \                     ??mqtt_rx_5:
   \   00006E                ; Setup parameters for call to function HalLedBlink
   \   00006E   7CF4         MOV       R4,#-0xc
   \   000070   7D01         MOV       R5,#0x1
   \   000072   7B32         MOV       R3,#0x32
   \   000074   7A05         MOV       R2,#0x5
   \   000076   7901         MOV       R1,#0x1
   \   000078   12....       LCALL     `??HalLedBlink::?relay`; Banked call to: HalLedBlink
    512          
    513            AF_DataRequest(&SampleApp_P2P_DstAddr,  //&Endevice_Add,  //目的节点网络地址和发送格式
    514                           &SampleApp_epDesc,       //目的地址端口号
    515                           SAMPLEAPP_CTE_CLUSTERID, //命令号，用于区别命令 coor to end
    516                           7,                       //osal_strlen(uartbuf),    //发送数据的长度
    517                           uartbuf,                 //发送数据的缓冲区
                                  ^
Warning[Pe167]: argument of type "char *" is incompatible with parameter of
          type "uint8 *"

    char *this_topic = NULL;
          ^
"C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c",480  Warning[Pe177]: 
          variable "this_topic" was declared but never referenced
    518                           &SampleApp_MsgID,        //发送序号,发完+1
    519                           AF_DISCV_ROUTE,
    520                           AF_DEFAULT_RADIUS);
   \   00007B                ; Setup parameters for call to function AF_DataRequest
   \   00007B   75..1E       MOV       ?V0,#0x1e
   \   00007E   78..         MOV       R0,#?V0
   \   000080   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000083   75....       MOV       ?V0,#SampleApp_MsgID & 0xff
   \   000086   75....       MOV       ?V1,#(SampleApp_MsgID >> 8) & 0xff
   \   000089   78..         MOV       R0,#?V0
   \   00008B   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00008E   7403         MOV       A,#0x3
   \   000090   12....       LCALL     ?XSTACK_DISP100_8
   \   000093   88..         MOV       ?V0,R0
   \   000095   89..         MOV       ?V1,R1
   \   000097   78..         MOV       R0,#?V0
   \   000099   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   00009C   75..07       MOV       ?V0,#0x7
   \   00009F   75..00       MOV       ?V1,#0x0
   \   0000A2   78..         MOV       R0,#?V0
   \   0000A4   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000A7   75..04       MOV       ?V0,#0x4
   \   0000AA   78..         MOV       R0,#?V0
   \   0000AC   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   0000AF   7920         MOV       R1,#0x20
   \   0000B1   7C..         MOV       R4,#SampleApp_epDesc & 0xff
   \   0000B3   7D..         MOV       R5,#(SampleApp_epDesc >> 8) & 0xff
   \   0000B5   7A..         MOV       R2,#SampleApp_P2P_DstAddr & 0xff
   \   0000B7   7B..         MOV       R3,#(SampleApp_P2P_DstAddr >> 8) & 0xff
   \   0000B9   12....       LCALL     `??AF_DataRequest::?relay`; Banked call to: AF_DataRequest
   \   0000BC   7409         MOV       A,#0x9
   \   0000BE   12....       LCALL     ?DEALLOC_XSTACK8
    521          }
   \                     ??mqtt_rx_2:
   \   0000C1   7408         MOV       A,#0x8
   \   0000C3   12....       LCALL     ?DEALLOC_XSTACK8
   \   0000C6   02....       LJMP      ?Subroutine1 & 0xFFFF
    522          
    523          void OneNet_publish_topic()
    524          {
    525            uint8 buff[20] = {0};
    526          
    527            sprintf(buff, "t:%d,h:%d", end_temp, end_hum);
                           ^
Warning[Pe167]: argument of type "uint8 *" is incompatible with parameter of
          type "char *"
    528          
    529            /*  发布主题为"hello_topic_public"，消息为温度和湿度 */
    530            if (0 == mqtt_publish_topic("hello_topic_public", buff))
                                                                     ^
Warning[Pe167]: argument of type "uint8 *" is incompatible with parameter of
          type "char const *"
    531            {
    532              ;
    533            }
    534          }
    535          
    536          /*********************************************************************
    537           * @fn      SampleApp_CallBack
    538           *
    539           * @brief   Send data OTA.
    540           *
    541           * @param   port - UART port.
    542           * @param   event - the UART port event flag.
    543           *
    544           * @return  none
    545           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    546          uint32 lastReadMs = 0;
   \                     lastReadMs:
   \   000000                DS 4
   \   000004                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    547          void SampleApp_CallBack(uint8 port, uint8 event)
   \                     SampleApp_CallBack:
    548          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V7
   \   000000   74F0         MOV       A,#-0x10
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
    549            (void)port;
    550          
    551            if (0 == onenet_login_ok)
   \   000005   90....       MOV       DPTR,#onenet_login_ok
   \   000008   E0           MOVX      A,@DPTR
   \   000009   7019         JNZ       ??SampleApp_CallBack_0
    552            {
    553              HalUARTRead(SAMPLE_APP_PORT, SampleApp_RxBuf, SAMPLE_APP_RX_MAX);
   \   00000B                ; Setup parameters for call to function HalUARTRead
   \   00000B   7CC8         MOV       R4,#-0x38
   \   00000D   7D00         MOV       R5,#0x0
   \   00000F   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   000011   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   000013   7900         MOV       R1,#0x0
   \   000015   12....       LCALL     `??HalUARTRead::?relay`; Banked call to: HalUARTRead
    554              SampleApp_RxLen = 0;
   \   000018   90....       MOV       DPTR,#SampleApp_RxLen
   \   00001B   E4           CLR       A
   \   00001C   F0           MOVX      @DPTR,A
   \   00001D   A3           INC       DPTR
   \   00001E   F0           MOVX      @DPTR,A
    555              osal_memset(SampleApp_RxBuf, 0, SAMPLE_APP_RX_MAX);
   \   00001F                ; Setup parameters for call to function osal_memset
   \   00001F   7CC8         MOV       R4,#-0x38
   \   000021   02....       LJMP      ??SampleApp_CallBack_1 & 0xFFFF
    556            }
    557            else if (1 == onenet_login_ok) //onenet注册成功 0:未注册，1：注册中　2：注册成功
   \                     ??SampleApp_CallBack_0:
   \   000024   6401         XRL       A,#0x1
   \   000026   7075         JNZ       ??SampleApp_CallBack_2
    558            {
    559              //一个一个字节读
    560              SampleApp_RxLen += HalUARTRead(SAMPLE_APP_PORT, SampleApp_RxBuf + SampleApp_RxLen, 4);
   \   000028                ; Setup parameters for call to function HalUARTRead
   \   000028   7C04         MOV       R4,#0x4
   \   00002A   7D00         MOV       R5,#0x0
   \   00002C   90....       MOV       DPTR,#SampleApp_RxLen
   \   00002F   E0           MOVX      A,@DPTR
   \   000030   24..         ADD       A,#SampleApp_RxBuf & 0xff
   \   000032   FA           MOV       R2,A
   \   000033   A3           INC       DPTR
   \   000034   E0           MOVX      A,@DPTR
   \   000035   34..         ADDC      A,#(SampleApp_RxBuf >> 8) & 0xff
   \   000037   FB           MOV       R3,A
   \   000038   7900         MOV       R1,#0x0
   \   00003A   12....       LCALL     `??HalUARTRead::?relay`; Banked call to: HalUARTRead
   \   00003D   8B..         MOV       ?V1,R3
   \   00003F   A9..         MOV       R1,?V1
   \   000041   90....       MOV       DPTR,#SampleApp_RxLen
   \   000044   E0           MOVX      A,@DPTR
   \   000045   2A           ADD       A,R2
   \   000046   F0           MOVX      @DPTR,A
   \   000047   A3           INC       DPTR
   \   000048   E0           MOVX      A,@DPTR
   \   000049   39           ADDC      A,R1
   \   00004A   F0           MOVX      @DPTR,A
    561          
    562              //判断是否是注册成功
    563              if (SampleApp_RxLen >= 4)
   \   00004B   90....       MOV       DPTR,#SampleApp_RxLen
   \   00004E   C3           CLR       C
   \   00004F   E0           MOVX      A,@DPTR
   \   000050   9404         SUBB      A,#0x4
   \   000052   A3           INC       DPTR
   \   000053   E0           MOVX      A,@DPTR
   \   000054   9400         SUBB      A,#0x0
   \   000056   402B         JC        ??SampleApp_CallBack_3
    564              {
    565                //        debug("rx len=%d(%x,%x,%x,%x)\r\n", SampleApp_RxLen,SampleApp_RxBuf[0],SampleApp_RxBuf[1],SampleApp_RxBuf[2],SampleApp_RxBuf[3]);
    566          
    567                //等待接入响应
    568                if (MQTT_UnPacketRecv(SampleApp_RxBuf) == MQTT_PKT_CONNACK)
   \   000058                ; Setup parameters for call to function MQTT_UnPacketRecv
   \   000058   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   00005A   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   00005C   12....       LCALL     `??MQTT_UnPacketRecv::?relay`; Banked call to: MQTT_UnPacketRecv
   \   00005F   E9           MOV       A,R1
   \   000060   6402         XRL       A,#0x2
   \   000062   701F         JNZ       ??SampleApp_CallBack_3
    569                {
    570                  if (0 == MQTT_UnPacketConnectAck(SampleApp_RxBuf))
   \   000064                ; Setup parameters for call to function MQTT_UnPacketConnectAck
   \   000064   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   000066   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   000068   12....       LCALL     `??MQTT_UnPacketConnectAck::?relay`; Banked call to: MQTT_UnPacketConnectAck
   \   00006B   E9           MOV       A,R1
   \   00006C   7015         JNZ       ??SampleApp_CallBack_3
    571                  {
    572                    onenet_login_ok = 2; //注册成功
   \   00006E   90....       MOV       DPTR,#onenet_login_ok
   \   000071   7402         MOV       A,#0x2
   \   000073   12....       LCALL     ?Subroutine4 & 0xFFFF
    573                    SampleApp_RxLen = 0;
    574          
    575                    //请求订阅主题
    576                    if (mqtt_subscribe_topic(g_mqtt_topics_set, 1) == 0)
                                                    ^
Warning[Pe167]: argument of type "signed char **" is incompatible with
          parameter of type "signed char const **"

  static void SampleApp_Send_P2P_Message(void);
              ^
"C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c",132  Warning[Pe177]: 
          function "SampleApp_Send_P2P_Message" was declared but never
          referenced

  void OneNet_publish_topic()
       ^
"C:\Users\OY\Desktop\ing\new\ZStack-2.5.1a\Projects\zstack\Samples\SampleApp\Source\SampleApp.c",523  Warning[Pe177]: 
          function "OneNet_publish_topic" was declared but never referenced
   \                     ??CrossCallReturnLabel_5:
   \   000076                ; Setup parameters for call to function mqtt_subscribe_topic
   \   000076   7901         MOV       R1,#0x1
   \   000078   7A..         MOV       R2,#g_mqtt_topics_set & 0xff
   \   00007A   7B..         MOV       R3,#(g_mqtt_topics_set >> 8) & 0xff
   \   00007C   12....       LCALL     `??mqtt_subscribe_topic::?relay`; Banked call to: mqtt_subscribe_topic
   \   00007F   4002         JC        ??SampleApp_CallBack_3
    577                    {
    578                      //订阅成功P1_4  D3变为亮
    579                      P1_4 = 0;
   \   000081   C294         CLR       0x90.4
    580                    }
    581                  }
    582                }
    583              }
    584          
    585              //数组满，清0
    586              if (SampleApp_RxLen >= SAMPLE_APP_RX_MAX)
   \                     ??SampleApp_CallBack_3:
   \   000083   90....       MOV       DPTR,#SampleApp_RxLen
   \   000086   C3           CLR       C
   \   000087   E0           MOVX      A,@DPTR
   \   000088   94C8         SUBB      A,#-0x38
   \   00008A   A3           INC       DPTR
   \   00008B   E0           MOVX      A,@DPTR
   \   00008C   9400         SUBB      A,#0x0
   \   00008E   5003         JNC       $+5
   \   000090   02....       LJMP      ??SampleApp_CallBack_4 & 0xFFFF
    587              {
    588                SampleApp_RxLen = 0;
   \   000093   90....       MOV       DPTR,#SampleApp_RxLen
   \   000096   E4           CLR       A
   \   000097   F0           MOVX      @DPTR,A
   \   000098   A3           INC       DPTR
   \   000099   F0           MOVX      @DPTR,A
   \   00009A   02....       LJMP      ??SampleApp_CallBack_4 & 0xFFFF
    589              }
    590            }
    591            else if (2 == onenet_login_ok)
   \                     ??SampleApp_CallBack_2:
   \   00009D   E0           MOVX      A,@DPTR
   \   00009E   6402         XRL       A,#0x2
   \   0000A0   6003         JZ        $+5
   \   0000A2   02....       LJMP      ??SampleApp_CallBack_4 & 0xFFFF
    592            {
    593              //如果是注册成功，读服务器的控制命令
    594          
    595              uint32 curMs = osal_GetSystemClock();
   \   0000A5                ; Setup parameters for call to function osal_GetSystemClock
   \   0000A5   12....       LCALL     `??osal_GetSystemClock::?relay`; Banked call to: osal_GetSystemClock
   \   0000A8   8A..         MOV       ?V4,R2
   \   0000AA   8B..         MOV       ?V5,R3
   \   0000AC   8C..         MOV       ?V6,R4
   \   0000AE   8D..         MOV       ?V7,R5
    596          
    597              if ((curMs - lastReadMs) < 1000)
   \   0000B0   90....       MOV       DPTR,#__Constant_3e8
   \   0000B3   C082         PUSH      DPL
   \   0000B5   8A..         MOV       ?V0,R2
   \   0000B7   8B..         MOV       ?V1,R3
   \   0000B9   8C..         MOV       ?V2,R4
   \   0000BB   8D..         MOV       ?V3,R5
   \   0000BD   90....       MOV       DPTR,#lastReadMs
   \   0000C0   78..         MOV       R0,#?V0
   \   0000C2   12....       LCALL     ?L_SUB_X
   \   0000C5   7583..       MOV       DPH,#(__Constant_3e8 >> 8) & 0xff
   \   0000C8   D082         POP       DPL
   \   0000CA   78..         MOV       R0,#?V0
   \   0000CC   12....       LCALL     ?UL_GE_X
   \   0000CF   505F         JNC       ??SampleApp_CallBack_4
    598                return;
    599          
    600              lastReadMs = curMs;
   \   0000D1   90....       MOV       DPTR,#lastReadMs
   \   0000D4   78..         MOV       R0,#?V4
   \   0000D6   12....       LCALL     ?L_MOV_TO_X
    601              SampleApp_RxLen = 0;
   \   0000D9   90....       MOV       DPTR,#SampleApp_RxLen
   \   0000DC   E4           CLR       A
   \   0000DD   F0           MOVX      @DPTR,A
   \   0000DE   A3           INC       DPTR
   \   0000DF   F0           MOVX      @DPTR,A
    602              osal_memset(SampleApp_RxBuf, 0, SAMPLE_APP_RX_MAX + 1);
   \   0000E0                ; Setup parameters for call to function osal_memset
   \   0000E0   7CC9         MOV       R4,#-0x37
   \   0000E2   FD           MOV       R5,A
   \   0000E3   F9           MOV       R1,A
   \   0000E4   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   0000E6   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   0000E8   12....       LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
    603              SampleApp_RxLen = HalUARTRead(SAMPLE_APP_PORT, SampleApp_RxBuf, SAMPLE_APP_RX_MAX); //读长200的数据
   \   0000EB                ; Setup parameters for call to function HalUARTRead
   \   0000EB   7CC8         MOV       R4,#-0x38
   \   0000ED   7D00         MOV       R5,#0x0
   \   0000EF   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   0000F1   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   0000F3   7900         MOV       R1,#0x0
   \   0000F5   12....       LCALL     `??HalUARTRead::?relay`; Banked call to: HalUARTRead
   \   0000F8   90....       MOV       DPTR,#SampleApp_RxLen
   \   0000FB   EA           MOV       A,R2
   \   0000FC   F0           MOVX      @DPTR,A
   \   0000FD   A3           INC       DPTR
   \   0000FE   EB           MOV       A,R3
   \   0000FF   F0           MOVX      @DPTR,A
    604          
    605              if (SampleApp_RxLen > 0)
   \   000100   F9           MOV       R1,A
   \   000101   EA           MOV       A,R2
   \   000102   49           ORL       A,R1
   \   000103   602B         JZ        ??SampleApp_CallBack_4
    606              {
    607                debug("rx len=%d.\r\n", SampleApp_RxLen);
   \   000105                ; Setup parameters for call to function debug
   \   000105   90....       MOV       DPTR,#SampleApp_RxLen
   \   000108   12....       LCALL     ?PUSH_XSTACK8_X_TWO
   \   00010B   7A..         MOV       R2,#`?<Constant "rx len=%d.\\r\\n">` & 0xff
   \   00010D   7B..         MOV       R3,#(`?<Constant "rx len=%d.\\r\\n">` >> 8) & 0xff
   \   00010F   12....       LCALL     `??debug::?relay`; Banked call to: debug
   \   000112   7402         MOV       A,#0x2
   \   000114   12....       LCALL     ?DEALLOC_XSTACK8
    608                //接收消息
    609                OneNet_RevPro(SampleApp_RxBuf);
   \   000117                ; Setup parameters for call to function OneNet_RevPro
   \   000117   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   000119   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   00011B   12....       LCALL     `??OneNet_RevPro::?relay`; Banked call to: OneNet_RevPro
    610                //debug LED3
    611                //        HalLedBlink (HAL_LED_3, 5, 50, 500); //HalLedSet
    612                SampleApp_RxLen = 0;
   \   00011E   90....       MOV       DPTR,#SampleApp_RxLen
   \   000121   E4           CLR       A
   \   000122   F0           MOVX      @DPTR,A
   \   000123   A3           INC       DPTR
   \   000124   F0           MOVX      @DPTR,A
    613                osal_memset(SampleApp_RxBuf, 0, SAMPLE_APP_RX_MAX + 1);
   \   000125                ; Setup parameters for call to function osal_memset
   \   000125   7CC9         MOV       R4,#-0x37
   \                     ??SampleApp_CallBack_1:
   \   000127   FD           MOV       R5,A
   \   000128   F9           MOV       R1,A
   \   000129   7A..         MOV       R2,#SampleApp_RxBuf & 0xff
   \   00012B   7B..         MOV       R3,#(SampleApp_RxBuf >> 8) & 0xff
   \   00012D   12....       LCALL     `??osal_memset::?relay`; Banked call to: osal_memset
    614              }
    615            }
    616          }
   \                     ??SampleApp_CallBack_4:
   \   000130   7F08         MOV       R7,#0x8
   \   000132   02....       LJMP      ?BANKED_LEAVE_XDATA
   \   000135                REQUIRE _A_P1
    617          
    618          #else
    619          #include "hal_ADC.h"
    620          /*********************************************************************
    621           * @fn      SampleApp_Send_P2P_Message
    622           *
    623           * @brief   point to point.
    624           *
    625           * @param   none
    626           *
    627           * @return  none
    628           */
    629          void SampleApp_Send_P2P_Message(void)
    630          {
    631            uint8 str[10] = {0};
    632            uint8 strTemp[20] = {0};
    633            uint8 end_obstacles_temp = 0;
    634            uint8 end_buzzer_temp = 0;
    635            uint8 end_man_temp = 0;
    636            int len = 0;
    637          
    638            osal_memset(str, '\0', 10);
    639            osal_memset(strTemp, '\0', 20);
    640          
    641            DHT11(); //获取温湿度
    642          
    643            HalAdcInit();
    644            uint8 end_light_temp = HalAdcRead(HAL_ADC_CHANNEL_6, HAL_ADC_RESOLUTION_8); //P0_6
    645            uint8 end_smoke_temp = HalAdcRead(HAL_ADC_CHANNEL_4, HAL_ADC_RESOLUTION_8); //P0_4
    646            uint8 end_led2_temp = 0;
    647          
    648            if (P1_1 == 1)
    649              end_led2_temp = 0;
    650            else
    651              end_led2_temp = 1;
    652          
    653            //障碍物检查
    654            if (P0_5 == 1) //拉高
    655            {
    656              end_obstacles_temp = 0;
    657            }
    658            else
    659              end_obstacles_temp = 1;
    660            if (P2_0 == 1)
    661              end_man_temp = 1;
    662            else
    663              end_man_temp = 0;
    664            str[0] = wendu; //温度
    665            str[1] = shidu; //湿度
    666          
    667            str[2] = end_light_temp;     //亮度
    668            str[3] = end_led2_temp;      //led3状态
    669            str[4] = end_obstacles_temp; //障碍物情况
    670            str[5] = end_smoke_temp;     //烟雾数值
    671            str[6] = end_man_temp;       //人体
    672            //str[5] = end_buzzer_temp;    //buzzer情况
    673            len = 6;
    674            sprintf(strTemp, "T&H:%d %d", str[0], str[1]);
    675            HalLcdWriteString(strTemp, HAL_LCD_LINE_3); //LCD显示
    676          
    677            HalUARTWrite(0, strTemp, osal_strlen(strTemp)); //串口输出提示信息
    678            HalUARTWrite(0, "\r\n", 2);
    679          
    680            //无线发送到协调器
    681            if (AF_DataRequest(&SampleApp_P2P_DstAddr, &SampleApp_epDesc,
    682                               SAMPLEAPP_P2P_CLUSTERID,
    683                               7,//osal_strlen(str), //这个有bugosal得出33
    684                               str,
    685                               &SampleApp_MsgID,
    686                               AF_DISCV_ROUTE,
    687                               AF_DEFAULT_RADIUS) == afStatus_SUCCESS)
    688            {
    689            }
    690            else
    691            {
    692              // Error occurred in request to send.
    693            }
    694          }
    695          
    696          void SampleApp_CallBack(uint8 port, uint8 event)
    697          {
    698            (void)port;
    699          
    700            HalUARTRead(SAMPLE_APP_PORT, SampleApp_RxBuf, 1);
    701          }
    702          
    703          #endif
    704          
    705          //调试信息输出

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    706          void debug(uint8 *msg, ...)
   \                     debug:
    707          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    708          #if 0
    709              uint8 len=0;
    710              char info[200] = {0};
    711              va_list args;
    712          
    713              if(msg==NULL) return;
    714          
    715              va_start(args, msg);
    716              vsprintf(info, (const char*)msg, args);//从头插入到info中
    717              va_end(args);
    718              
    719              
    720              len=osal_strlen((char *)info);
    721              if(len==0) return;
    722              
    723              
    724          
    725              HalUARTWrite(1,info, len);//串口1发送
    726              osal_memset(info,'\0',200);
    727          //    HAL_UART_PORT_0
    728          #endif
    729          }
   \   000000   02....       LJMP      ?BRET

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for SampleApp_epDesc>`:
   \   000000   0B           DB 11
   \   000001   ....         DW SampleApp_TaskID
   \   000003   ....         DW SampleApp_SimpleDesc
   \   000005   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "/post">`:
   \   000000   2F706F73     DB "/post"
   \            7400    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "/set">`:
   \   000000   2F736574     DB "/set"
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "mqtt_topic_test1">`:
   \   000000   6D717474     DB "mqtt_topic_test1"
   \            5F746F70
   \            69635F74
   \            65737431
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "{\\"method\\":\\"thing.serv...">`:
   \   000000   7B226D65     DB 7BH, 22H, 6DH, 65H, 74H, 68H, 6FH, 64H
   \            74686F64
   \   000008   223A2274     DB 22H, 3AH, 22H, 74H, 68H, 69H, 6EH, 67H
   \            68696E67
   \   000010   2E736572     DB 2EH, 73H, 65H, 72H, 76H, 69H, 63H, 65H
   \            76696365
   \   000018   2E70726F     DB 2EH, 70H, 72H, 6FH, 70H, 65H, 72H, 74H
   \            70657274
   \   000020   792E7365     DB 79H, 2EH, 73H, 65H, 74H, 22H, 2CH, 22H
   \            74222C22
   \   000028   6964223A     DB 69H, 64H, 22H, 3AH, 22H, 36H, 33H, 30H
   \            22363330
   \   000030   32363233     DB 32H, 36H, 32H, 33H, 30H, 36H, 22H, 2CH
   \            3036222C
   \   000038   22706172     DB 22H, 70H, 61H, 72H, 61H, 6DH, 73H, 22H
   \            616D7322
   \   000040   3A7B2020     DB 3AH, 7BH, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   000048   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 22H, 74H
   \            20202274
   \   000050   656D7022     DB 65H, 6DH, 70H, 22H, 3AH, 25H, 64H, 2CH
   \            3A25642C
   \   000058   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   000060   20202020     DB 20H, 20H, 20H, 20H, 22H, 68H, 75H, 6DH
   \            2268756D
   \   000068   223A2564     DB 22H, 3AH, 25H, 64H, 2CH, 20H, 20H, 20H
   \            2C202020
   \   000070   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   000078   20202020     DB 20H, 20H, 20H, 20H, 22H, 65H, 6EH, 64H
   \            22656E64
   \   000080   5F6C6967     DB 5FH, 6CH, 69H, 67H, 68H, 74H, 22H, 3AH
   \            6874223A
   \   000088   25642C20     DB 25H, 64H, 2CH, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   000090   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   000098   2022656E     DB 20H, 22H, 65H, 6EH, 64H, 5FH, 6CH, 65H
   \            645F6C65
   \   0000A0   6432223A     DB 64H, 32H, 22H, 3AH, 25H, 64H, 2CH, 9
   \            25642C09
   \   0000A8   09092020     DB 9, 9, 20H, 20H, 22H, 65H, 6EH, 64H
   \            22656E64
   \   0000B0   5F6F6273     DB 5FH, 6FH, 62H, 73H, 74H, 61H, 63H, 6CH
   \            7461636C
   \   0000B8   6573223A     DB 65H, 73H, 22H, 3AH, 25H, 64H, 2CH, 20H
   \            25642C20
   \   0000C0   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   0000C8   2022656E     DB 20H, 22H, 65H, 6EH, 64H, 5FH, 73H, 6DH
   \            645F736D
   \   0000D0   6F6B6522     DB 6FH, 6BH, 65H, 22H, 3AH, 25H, 64H, 2CH
   \            3A25642C
   \   0000D8   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   0000E0   20202265     DB 20H, 20H, 22H, 65H, 6EH, 64H, 5FH, 6DH
   \            6E645F6D
   \   0000E8   616E223A     DB 61H, 6EH, 22H, 3AH, 25H, 64H, 20H, 7DH
   \            2564207D
   \   0000F0   20202020     DB 20H, 20H, 20H, 20H, 20H, 20H, 20H, 20H
   \            20202020
   \   0000F8   7D00         DB 7DH, 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0`:
   \   000000   00           DB 0
   \   000001   00           DB 0
   \   000002   00           DB 0
   \   000003   00           DB 0
   \   000004   00           DB 0
   \   000005   00           DB 0
   \   000006   00           DB 0
   \   000007   00           DB 0
   \   000008   00           DB 0
   \   000009   00           DB 0
   \   00000A   00           DB 0
   \   00000B   00           DB 0
   \   00000C   00           DB 0
   \   00000D   00           DB 0
   \   00000E   00           DB 0
   \   00000F   00           DB 0
   \   000010   00           DB 0
   \   000011   00           DB 0
   \   000012   00           DB 0
   \   000013   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "T:%d">`:
   \   000000   543A2564     DB "T:%d"
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "H:%d">`:
   \   000000   483A2564     DB "H:%d"
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\r\\n">`:
   \   000000   0D0A00       DB "\015\012"

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "D2:0">`:
   \   000000   44323A30     DB "D2:0"
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "D2:1">`:
   \   000000   44323A31     DB "D2:1"
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {68, 50, 58, 32, 66, 58, 32, 0}>`:
   \   000000   44           DB 68
   \   000001   32           DB 50
   \   000002   3A           DB 58
   \   000003   20           DB 32
   \   000004   42           DB 66
   \   000005   3A           DB 58
   \   000006   20           DB 32
   \   000007   00           DB 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\"led\\":1">`:
   \   000000   226C6564     DB "\"led\":1"
   \            223A3100

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\"led\\":0">`:
   \   000000   226C6564     DB "\"led\":0"
   \            223A3000

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "rx len=%d.\\r\\n">`:
   \   000000   7278206C     DB "rx len=%d.\015\012"
   \            656E3D25
   \            642E0D0A
   \            00      

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3e8:
   \   000000   E8030000     DD 1000

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      2      0   ESP8266_SendData
        2      0   -> HalUARTWrite
      2     18   SampleApp_CallBack
        0     16   -> HalUARTRead
        0     16   -> MQTT_UnPacketConnectAck
        0     16   -> MQTT_UnPacketRecv
        0     16   -> OneNet_RevPro
        0     18   -> debug
        0     16   -> mqtt_subscribe_topic
        0     16   -> osal_GetSystemClock
        0     16   -> osal_memset
      0     23   SampleApp_HandleKeys
        0     11   -> mqtt_subscribe_topic
      0     15   SampleApp_Init
        0     15   -> MT_UartInit
        0     15   -> MT_UartRegisterTaskID
        0     15   -> RegisterForKeys
        0     15   -> afRegister
        0     15   -> sprintf
      0     26   SampleApp_ProcessEvent
        0     12   -> HalLedBlink
        0     12   -> OneNet_DevLink
        0     12   -> SampleApp_HandleKeys
        0     12   -> SampleApp_ProcessMSGCmd
        0     12   -> mqtt_publish_topic
        0     12   -> onenet_mqtt_send_heart
        0     12   -> osal_msg_deallocate
        0     12   -> osal_msg_receive
        0     12   -> osal_start_timerEx
        0     26   -> sprintf
      0    174   SampleApp_ProcessMSGCmd
        0    159   -> HalLcdWriteString
        0    159   -> HalLedSet
        0    159   -> HalUARTWrite
        0    162   -> osal_memcpy
        0    159   -> osal_memset
        0    159   -> osal_strlen
        0    161   -> sprintf
        0    159   -> strstr
      0     18   debug
      0     29   mqtt_rx
        0     29   -> AF_DataRequest
        0     20   -> HalLedBlink
        0     20   -> strstr


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       6  ?<Constant "/post">
       5  ?<Constant "/set">
       5  ?<Constant "D2:0">
       5  ?<Constant "D2:1">
       5  ?<Constant "H:%d">
       5  ?<Constant "T:%d">
       8  ?<Constant "\"led\":0">
       8  ?<Constant "\"led\":1">
       3  ?<Constant "\r\n">
      17  ?<Constant "mqtt_topic_test1">
      13  ?<Constant "rx len=%d.\r\n">
     250  ?<Constant "{\"method\":\"thing.serv...">
       2  ?<Constant {&"mqtt_topic_test1"}>
      20  ?<Constant {0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
       8  ?<Constant {68, 50, 58, 32, 66, 58, 32, 0}>
       6  ?<Initializer for SampleApp_epDesc>
       6  ??Subroutine12_0
       8  ?Subroutine0
       5  ?Subroutine1
      11  ?Subroutine10
       9  ?Subroutine11
       6  ?Subroutine2
       4  ?Subroutine3
       9  ?Subroutine4
       3  ?Subroutine5
       5  ?Subroutine6
       4  ?Subroutine7
       9  ?Subroutine8
      11  ?Subroutine9
      20  ESP8266_SendData
     309  SampleApp_CallBack
       8  SampleApp_ClusterList
      40  SampleApp_HandleKeys
     143  SampleApp_Init
       1  SampleApp_MsgID
       1  SampleApp_NwkState
      12  SampleApp_P2P_DstAddr
     335  SampleApp_ProcessEvent
     384  SampleApp_ProcessMSGCmd
     201  SampleApp_RxBuf
       2  SampleApp_RxLen
      12  SampleApp_SimpleDesc
       1  SampleApp_TaskID
       6  SampleApp_epDesc
       1  _A_P1
       4  __Constant_3e8
       1  cor_led3
       3  debug
       1  end_buzzer
       1  end_hum
       1  end_led2
       1  end_light
       1  end_man
       1  end_obstacles
       1  end_smoke
       1  end_temp
      10  g_mqtt_topics_set
       4  lastReadMs
     200  mqtt_message
     201  mqtt_rx
       1  onenet_login_ok
      60  topics_buff
     100  topics_post
      48  -- Other

 
 1 525 bytes in segment BANKED_CODE
    48 bytes in segment BANK_RELAYS
     1 byte  in segment SFR_AN
     6 bytes in segment XDATA_I
     6 bytes in segment XDATA_ID
   384 bytes in segment XDATA_ROM_C
   602 bytes in segment XDATA_Z
 
    54 bytes of CODE     memory
   380 bytes of CONST    memory (+ 4 bytes shared)
     0 bytes of DATA     memory (+ 1 byte  shared)
 1 525 bytes of HUGECODE memory
   608 bytes of XDATA    memory

Errors: none
Warnings: 22
